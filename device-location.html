<dom-module id="device-location">
<script>
  
DeviceLocation = Polymer({
    is: "device-location",
    properties: {
      lat : {
        type: Number,
        value: 0,
        reflectToAttribute: false
      },
      lon : {
        type: Number,
        value: 0,
        reflectToAttribute: false
      }
    },
    detached: function() {
        if (this._watchID) {
            navigator.geolocation.clearWatch(this._watchID);
            delete this._watchID;
        }
    },
    ready: function() {
        var self = this,
            options = {
                    enableHighAccuracy: true,
                    timeout: 5000,
                    maximumAge: 0
                };
            function moveTo(position) {
                self.lat = position.coords.latitude;
                self.lon = position.coords.longitude;
                if (self.parentNode.zoomTo && self.parentNode._map) {
                    self.parentNode.zoomTo(self.lat,self.lon,self.parentNode.zoom+1);
                }
            };
        this._watchID = navigator.geolocation.watchPosition(moveTo,null,options);
    }
});
</script>
</dom-module>
