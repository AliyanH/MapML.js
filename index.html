<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTML &lt;map&gt; custom element</title>
    <link rel="icon" href="MapsForHTML_16x16.png" sizes="16x16">
    <script src="bower_components/webcomponentsjs/webcomponents-lite.min.js"></script>
    <link rel="import" href="bower_components/web-map/web-map.html">
    <link rel="preconnect dns-prefetch" href="https://geogratis.gc.ca" crossorigin>
    <link rel="preconnect dns-prefetch" href="https://a.tile.openstreetmap.org" crossorigin>
    <link rel="preconnect dns-prefetch" href="https://b.tile.openstreetmap.org" crossorigin>
    <link rel="preconnect dns-prefetch" href="https://c.tile.openstreetmap.org" crossorigin>
    <link rel="dns-prefetch" href="https://geoappext.nrcan.gc.ca">
    <link rel="dns-prefetch" href="https://server.arcgisonline.com">
    <style>
        html {
            overflow-x: hidden;
        }

        body {
            max-width: 60em;
            margin: 0 auto;
            padding: 0 1rem 1rem;
            font-family: Verdana, sans-serif;
        }

        .code-example {
            display: block;
            overflow-x: auto;
            margin-bottom: 1rem;
            padding: 1rem 1rem 0 1rem;
            background-color: #f9f9f9;
        }

        .font-inherit {
            font: inherit;
        }

        code:not(.font-inherit) {
            font-size: 1.1rem;
        }

        pre {
            margin-bottom: 0;
        }

        hr {
            border: 0;
            height: 0;
            border-top: 1px solid hsla(0, 0%, 60%, 0.2);
            margin: 1.5rem 0 1rem 0;
        }

        .leaflet-container {
          border: 1px solid #f2f2f2;
        }

        .code-example,
        .leaflet-container {
          border-radius: 2px;
        }

        /* map must have a defined height and width, can be set either by height/width attributes, or with CSS properties */
        map {
            height: 350px;
            width: 640px;
        }

        .mapclasstest {
            height: 300px;
            width: 600px;
        }

        .transparency {
            opacity: 0.2;
        }

        area#line {
            fill: none;
            stroke: purple;
            stroke-width: 7px;
            stroke-opacity: 1.0;
            stroke-linecap: round;
        }

        /* Dark-mode styles modified from https://maps4html.org/ */
        @media (prefers-color-scheme: dark) {
          body {
            color: #d8e0ff;
            background: #002020;
          }

          .code-example {
            background: #021818;
          }

          h1, h2, h3, h4, h5, h6 {
            background: hsla(0, 0%, 0%, 0.3);
          }

          a:link {
              color: #68f;
          }

          a:visited {
              color: #a5d;
          }
        }
    </style>
</head>

<body>
    <h1>Web Map Custom Element - Maps4HTML</h1>
    <p>Want to help improve the HTML <a href="https://maps4html.github.io/HTML-Map-Element/spec/"><code class="font-inherit">&lt;map&gt;</code></a> element? Join the <a href="https://www.w3.org/community/maps4html/"><abbr title="World Wide Web Consortium">W3C</abbr> Maps for HTML Community Group</a> and send us your comments on <a target="_blank" rel="noopener" href="https://discourse.wicg.io/c/web-mapping/"><abbr title="Web Incubator Community Group">WICG</abbr> Discourse</a> or contribute on <a href="https://github.com/Maps4HTML">Github</a>.</p>

    <hr>

    <p>The following maps are a few examples of how the <a href="https://maps4html.github.io/HTML-Map-Element/spec/"><code>&lt;map&gt;</code></a> <a href="https://github.com/Maps4HTML/Web-Map-Custom-Element">custom element</a> works. Each map is preceded by the markup that creates the map, and each map is annotated to describe and point out the effect of the markup.</p>

    <pre class="code-example">
&lt;map is="web-map" zoom="17" lat="45.398043" lon="-75.70683" width="700" height="400" controls&gt;
  &lt;layer- id="osm" src="https://geogratis.gc.ca/mapml/en/osmtile/osm/" label="OpenStreetMap" checked hidden>&lt;/layer-&gt;
  &lt;layer- id="cbmt" src="https://geogratis.gc.ca/mapml/en/osmtile/cbmt/" label="Canada Base Map"&gt;&lt;/layer-&gt;
  &lt;layer- id="canvec" src="https://geogratis.gc.ca/api/beta/vectors/canvec/50k/features/" label="CanVec+ 031G" class="transparency"&gt;&lt;/layer-&gt;
  &lt;layer- id="marker" src="marker.mapml" label="Marker layer" checked&gt;&lt;/layer-&gt;
  &lt;area is="map-area" id="marker2" href="https://example.com/marker/" alt="Marker" coords="265,185" shape="marker"&gt;
  &lt;area is="map-area" id="line" href="https://example.com/line/" alt="Line" coords="275,275,540,107" shape="line"&gt;
  &lt;area is="map-area" id="doughnut" href="https://example.com/circle/" alt="Circle" coords="250,250,25" shape="circle" style="fill: white; stroke: aqua; stroke-width: 5px; fill-opacity: 0.0"&gt;
  &lt;area is="map-area" id="hole" alt="Hole" coords="250,250,7" shape="circle" style="fill: blue; stroke: none; fill-opacity: 0.3;"&gt;
  &lt;area is="map-area" id="rect" href="https://example.com/rectangle/" alt="Rectangle" coords="345,290,415,320" shape="rect" style="fill: greenyellow; stroke: blue; stroke-width: 3px; fill-opacity: 0.4"&gt;
  &lt;area is="map-area" id="poly" href="https://example.com/polygon/" alt="Polygon" coords="392,116,430,100,441,128,405,145" shape="poly" style="fill: pink; stroke: blue; stroke-width: 3px; fill-opacity: 0.4"&gt;
&lt;/map&gt;
    </pre>

    <!-- the @width / @height attributes take precedence over properties, but currently don't change to reflect updates -->
    <img usemap="#dowslake" src="map1.png" width="700" height="400" alt="Dow's Lake area" />
    <map name="dowslake" is="web-map" zoom="17" lat="45.398043" lon="-75.70683" width="700" height="400" controls>
        <layer- id="osm" src="https://geogratis.gc.ca/mapml/en/osmtile/osm/" label="OpenStreetMap" checked hidden></layer->
        <layer- id="cbmt" src="https://geogratis.gc.ca/mapml/en/osmtile/cbmt/" label="Canada Base Map"></layer->
        <layer- id="canvec" src="https://geogratis.gc.ca/api/beta/vectors/canvec/50k/features/" label="CanVec+ 031G" class="transparency"></layer->
        <!-- the HTML author can create MapML files and serve them as layers if they prefer -->
        <layer- id="marker" label="Marker layer" src="marker.mapml" checked></layer->

        <!-- or the HTML author can create map 'area's (links) within the HTML document -->
        <!-- <area is="map-area" id="wholemap" href='https://example.com/default/' alt="Default" shape="default" style="fill: salmon; stroke: none; fill-opacity: 0.01"/>-->
        <area is="map-area" id="marker2" href="https://example.com/marker/" alt="Marker" coords="265,185" shape="marker">
        <area is="map-area" id="line" href="https://example.com/line/" alt="Line" coords="275,275,540,107" shape="line">

        <area is="map-area" id="doughnut" href="https://example.com/circle/" alt="Circle" coords="250,250,25" shape="circle" style="fill: white; stroke: aqua; stroke-width: 5px; fill-opacity: 0.0">
        <area is="map-area" id="hole" alt="Hole" coords="250,250,7" shape="circle" style="fill: blue; stroke: none; fill-opacity: 0.3;">
        <area is="map-area" id="rect" href="https://example.com/rectangle/" alt="Rectangle" coords="345,290,415,320" shape="rect" style="fill: greenyellow; stroke: blue; stroke-width: 3px; fill-opacity: 0.4">
        <area is="map-area" id="poly" href="https://example.com/polygon/" alt="Polygon" coords="392,116,430,100,441,128,405,145" shape="poly" style="fill: pink; stroke: blue; stroke-width: 3px; fill-opacity: 0.4">
    </map>

    <p>This map illustrates a few of the features of the <a href="https://maps4html.github.io/HTML-Map-Element/spec/"><code>&lt;map&gt;</code></a> <a href="https://github.com/Maps4HTML/Web-Map-Custom-Element">custom element</a>.</p>
    <p>First, note that the map element has a <a href="https://maps4html.github.io/HTML-Map-Element/spec/#attr-map-controls"><code>controls</code></a> attribute. This requests the user-agent to present default controls, such as zoom and layer controls to the user.</p>
    <p>Also, there is no <a href="https://maps4html.github.io/HTML-Map-Element/spec/#attr-map-projection"><code>projection</code></a> attribute on the map element, and as a result, the map has the <a href="https://maps4html.github.io/HTML-Map-Element/spec/#projections">default projection</a> whose value is implicitly <a href="https://maps4html.org/MapML/spec/#OSMTILE"><code>OSMTILE</code></a>. Consequently, all the <a href="https://maps4html.github.io/HTML-Map-Element/spec/#the-layer-element"><code>&lt;layer-&gt;</code></a> element children of the map element must support the OSMTILE projection, otherwise they will be disabled by the web-map application.</p>
    <p>The layers have an inherent projection that is unknown to the client until the URL is fetched. When the <a href="https://maps4html.github.io/MapML/spec/"><abbr title="Map Markup Language">MapML</abbr> response</a> is parsed, the code enables/disables the layer in the layer control checkbox based on whether the layer shares the projection of the map element, and is visible i.e. within the zoom and bounds of the map.</p>

    <p>Next, the first <code>&lt;layer-&gt;</code> child of map element is the <code>id="osm"</code> layer, which is declared <a href="https://maps4html.github.io/HTML-Map-Element/spec/#attr-layer-checked"><code>checked</code></a> and <a href="https://maps4html.github.io/HTML-Map-Element/spec/#attr-layer-hidden"><code>hidden</code></a>. As a result, it is displayed on the map, but not in the controls.</p>

    <p>Although the <code>id="cbmt"</code> layer shares the OSMTILE projection and it has a <code>checked</code> attribute directing it to be displayed, when the page is loaded the map discovers that the layer resource does not serve the zoom level at which the map initially loads, and therefore it is initially disabled in the layer control. Zooming out a few levels should result in the <code>id="cbmt"</code> layer being enabled/available in the layer control and displayed on the map. This behaviour also illustrates the <a href="https://www.w3.org/TR/SVG/render.html#PaintersModel">painters model</a> in which <code>&lt;layer-&gt;</code> elements which are later in document order are drawn on top of earlier layer- elements</p>
    <p>The <code>id="canvec"</code> layer is a vector feature layer in the <a href="https://maps4html.github.io/MapML/spec/#WGS84">MapML WGS84 projection</a>. The layer references a linked CSS stylesheet. The WGS84 projection is a kind of "wildcard" coordinate reference system that can be overlayed on any projected coordinate reference system known to MapML. It is initially enabled and available in the layer control because it overlaps the map element's initial extent and zoom level. If you pan or zoom the map, it too should be enabled/disabled automatically based on the discovered <a href="https://maps4html.github.io/MapML/spec/#the-extent-element">extent</a>.
    </p>

    <p>The map includes a few <a href="https://maps4html.github.io/HTML-Map-Element/spec/#the-area-element"><code>&lt;area&gt;</code></a> links, which are similar to the standard <a href="https://html.spec.whatwg.org/multipage/image-maps.html#the-map-element">map</a> element's <a href="https://html.spec.whatwg.org/multipage/image-maps.html#the-area-element">area</a> element children. These elements create a style-able map feature and optionally declare it as a hyperlink. There are two additional <a href="https://maps4html.org/HTML-Map-Element/spec/#attr-area-shape"><code>shape</code></a> attribute values allowed compared to the standard area element: <a href="https://maps4html.org/HTML-Map-Element/spec/#attr-area-shape-marker"><code>marker</code></a> and <a href="https://maps4html.org/HTML-Map-Element/spec/#attr-area-shape-line"><code>line</code></a>. The marker value designates a point feature to be symbolized. The intention of the implementation is to allow such markers to be styled with CSS and represented by SVG graphic symbols. The current custom element implementation uses a fixed familiar place marker icon image.</p>

    <p>Finally, the layer control shows a layer called "Marker layer", which is a <a href="marker.mapml">simple MapML file</a> created by the HTML author within their domain. This shows the different behaviour between features encoded in MapML and included as layers versus features encoded in HTML area elements and included on the map as links.</p>

    <hr>

    <pre class="code-example">
&lt;map is="web-map" zoom="2" lat="67.101360" lon="-91.121469" projection="CBMTILE" width="640" height="480" controls&gt;
  &lt;layer- src="https://geogratis.gc.ca/mapml/en/osmtile/osm/" label="OpenStreetMap" checked&gt;&lt;/layer-&gt;
  &lt;layer- src="https://geogratis.gc.ca/mapml/en/cbmtile/cbmt/" label="Canada Base Map" checked&gt;&lt;/layer-&gt;
  &lt;layer- src="https://geogratis.gc.ca/api/beta/vectors/canvec/50k/features/" label="CanVec+ 031G" class="transparency"&gt;&lt;/layer-&gt;
  &lt;layer- id="fdr" src="https://geogratis.gc.ca/mapml/en/cbmtile/fdi/" label="Fire Risk forecast" style="opacity: 0.4"&gt;&lt;/layer-&gt;
&lt;/map&gt;
    </pre>

    <img usemap="#canada" src="map2.png" width="640" height="480" alt="Canada" />
    <map name="canada" is="web-map" zoom="2" lat="67.101360" lon="-91.121469" projection="CBMTILE" width="640" height="480" controls>
        <layer- id="osm2" src="https://geogratis.gc.ca/mapml/en/osmtile/osm/" label="OpenStreetMap" checked></layer->
        <layer- id="cbmtlcc" src="https://geogratis.gc.ca/mapml/en/cbmtile/cbmt/" label="Canada Base Map" checked></layer->
        <layer- id="canvec2" src="https://geogratis.gc.ca/api/beta/vectors/canvec/50k/features/" label="CanVec+ 031G" class="transparency"></layer->
        <layer- id="fdr" src="https://geogratis.gc.ca/mapml/en/cbmtile/fdi/" label="Fire Risk forecast" style="opacity: 0.4"></layer->
    </map>

    <p>This map declares the <a href="https://maps4html.org/MapML/spec/#CBMTILE"><code>CBMTILE</code></a> projection, which is a <a href="https://maps4html.github.io/MapML/spec/#coordinate-reference-systems">coordinate reference system</a> in the Lambert Conformal Conic projection in MapML. The OpenStreetMap layer is in the Web Mercator (OSMTILE) projection, and is therefore disabled/unavailable, no matter how much you zoom and pan.</p>
    <p>If you zoom in on the Ottawa region displayed in the first map above (the map projected in the default OSMTILE projection), you can see that the <code>id="canvec2"</code> layer becomes enabled in the layer control, such that you can click/tap to enable it.</p>

    <hr>

    <p>The final example is the Arctic Ocean Base Map, which uses the <a href="https://maps4html.org/MapML/spec/#APSTILE"><code>APSTILE</code></a> projection, which is a <a href="https://maps4html.github.io/MapML/spec/#coordinate-reference-systems">coordinate reference system</a> based on the Polar Stereographic projection in MapML:</p>

    <pre class="code-example">
&lt;map is="web-map" zoom="3" lat="90.0" lon="0.0" projection="APSTILE" width="640" height="480"&gt;
  &lt;layer- src="https://geogratis.gc.ca/mapml/en/apstile/arctic/" label="Arctic Ocean Base Map" checked hidden>&lt;/layer-&gt;
  &lt;area id="northPole" is="map-area" shape="marker" href="https://example.com/santa/" alt="North Pole" coords="320,175"&gt;
&lt;/map&gt;
    </pre>

    <img usemap="#arctic" src="map3.png" width="640" height="350" alt="Arctic" />
    <map name="arctic" is="web-map" zoom="3" lat="90.0" lon="0.0" projection="APSTILE" width="640" height="480">
        <layer- src="https://geogratis.gc.ca/mapml/en/apstile/arctic/" label="Arctic Ocean Base Map" checked hidden></layer->
        <area id="northPole" is="map-area" shape="marker" href="https://example.com/santa/" alt="North Pole" coords="320,175">
    </map>

    <p>This map illustrates the dramatically different projection <code>APSTILE</code>, with an <code>&lt;area&gt;</code> link for the North Pole. The lack of a <code>controls</code> attribute on the map element results in a clean map that looks like an image but behaves like a map.</p>
    <p><small>The Arctic Ocean Base Map Terms of Use are available from <a target="_blank" rel="noopener" href="https://www.arcgis.com/home/item.html?id=305cb48615d743f89fe70ff3a819e59e">ArcGIS.com</a>.</small></p>

</body>

</html>
